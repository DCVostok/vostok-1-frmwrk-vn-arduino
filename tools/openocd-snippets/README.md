## Набор скриптов OpenOCD

По соответствующим папкам расположены скрипты и фрагменты кода для работы OpenOCD с необходимым микроконтроллером.
В большинстве случаев это файлы ```connect_*.cfg```, которые позволяют использовать выбранный отладчик и интерфейс отладки.

## Шпаргалка по OpenOCD

### Запуск и подключение к мк

Необходимо указать директорию скриптов OpenOCD и использовать соответствующий файл ```connect_*.cfg```.
P.S. Путь к папке скриптов OpenOCD также может быть указан с помощью переменной окружения ```OPENOCD_SCRIPTS```
```bash
openocd -s scripts -f connect_stlink.cfg
```

Можно использовать несколько ```.cfg``` файлов
```bash
openocd -f connect_stlink.cfg -f ../generic/mass_erase.cfg
```

Подключение и выполнение следующих команд
```bash
openocd -f connect_stlink.cfg -c "flash info 0" -c "exit"
```

Подключение через ```telnet``` для набора команд в интерактивном режиме
```bash
telnet localhost 4444
```

### [Команды] Программирование флеш-памяти

Программирование файла ```program.bin``` с адреса 0x00000000 верификаци и выход
```bash
program program.bin verify reset 0x00000000
```

Программирование ```.hex``` или ```.elf``` происходит аналогично (не нужно указывать адрес)
```bash
program program.hex verify reset
```

### [Команды] Стирание флеш-памяти

Стереть страницы с 0 по 3 включительно
```bash
flash erase_sector 0 0 3
```

Стереть всю флеш-память
```bash
flash erase_sector 0 0 last
```

### [Команды] Доступ к памяти

Прочитать 32-битное слово по адресу ```0x20000000```
```bash
mdw 0x20000000
```

Прочитать 4 32-битных слова, начиная с адреса ```0x20000000```
```bash
mdw 0x20000000 4
```

Записать 32-битное слово по адресу ```0x20000000```
```bash
mww 0x20000000 0xDEADBEEF
```

Сохранение дампа памяти в файл ```dump.bin``` размером 1кБ, начиная с адреса ```0x00000000```
```bash
dump_image dump.bin 0x00000000 0x400
```

Загрузка бинарного файла ```dump.bin``` в память, начиная с адреса ```0x00000000```
```bash
load_image dump.bin 0x00000000
```
